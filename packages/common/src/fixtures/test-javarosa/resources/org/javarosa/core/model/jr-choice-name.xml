<?xml version="1.0"?>
<!-- see binds for explanations of each case -->
<h:html xmlns="http://www.w3.org/2002/xforms" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:jr="http://openrosa.org/javarosa" xmlns:odk="http://www.opendatakit.org/xforms/">
    <h:head>
        <h:title>jr-choice-name</h:title>
        <model>
            <itext>
                <translation lang="French (fr)">
                    <text id="/jr-choice-name/select_one_outside:label">
                        <value>Faites un choix</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice1:label">
                        <value>Choix 1</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice2:label">
                        <value>Choix 2</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice3:label">
                        <value>Choix 3</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice4:label">
                        <value>Choix 4</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice5:label">
                        <value>Choix 5</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one:label">
                        <value>Faites un choix</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice1:label">
                        <value>Choix 1</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice2:label">
                        <value>Choix 2</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice3:label">
                        <value>Choix 3</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice4:label">
                        <value>Choix 4</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice5:label">
                        <value>Choix 5</value>
                    </text>
                    <text id="static_instance-choices-0">
                        <value>Choix 1</value>
                    </text>
                    <text id="static_instance-choices-1">
                        <value>Choix 2</value>
                    </text>
                    <text id="static_instance-choices-2">
                        <value>Choix 3</value>
                    </text>
                    <text id="static_instance-choices-3">
                        <value>Choix 4</value>
                    </text>
                    <text id="static_instance-choices-4">
                        <value>Choix 5</value>
                    </text>
                </translation>
                <translation lang="English (en)" default="">
                    <text id="/jr-choice-name/select_one_outside:label">
                        <value>Select one</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice1:label">
                        <value>Choice 1</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice2:label">
                        <value>Choice 2</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice3:label">
                        <value>Choice 3</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice4:label">
                        <value>Choice 4</value>
                    </text>
                    <text id="/jr-choice-name/select_one_outside/choice5:label">
                        <value>Choice 5</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one:label">
                        <value>Select one</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice1:label">
                        <value>Choice 1</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice2:label">
                        <value>Choice 2</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice3:label">
                        <value>Choice 3</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice4:label">
                        <value>Choice 4</value>
                    </text>
                    <text id="/jr-choice-name/my-repeat/select_one/choice5:label">
                        <value>Choice 5</value>
                    </text>
                    <text id="static_instance-choices-0">
                        <value>Choice 1</value>
                    </text>
                    <text id="static_instance-choices-1">
                        <value>Choice 2</value>
                    </text>
                    <text id="static_instance-choices-2">
                        <value>Choice 3</value>
                    </text>
                    <text id="static_instance-choices-3">
                        <value>Choice 4</value>
                    </text>
                    <text id="static_instance-choices-4">
                        <value>Choice 5</value>
                    </text>
                </translation>
            </itext>
            <instance>
                <jr-choice-name id="jr-choice-name">
                    <literal_choice_name/>
                    <select_one_outside/>
                    <select_one_name_outside/>

                    <cocotero_a/>
                    <cocotero_b/>
                    <cocotero/>
                    <cocotero_name/>

                    <my-repeat>
                        <select_one/>
                        <select_one_name/>
                    </my-repeat>

                    <rank/>
                    <rank_name/>

                    <meta>
                        <instanceID/>
                    </meta>
                </jr-choice-name>
            </instance>
            <instance id="choices">
                <root>
                    <item>
                        <itextId>static_instance-choices-0</itextId>
                        <name>choice1</name>
                    </item>
                    <item>
                        <itextId>static_instance-choices-1</itextId>
                        <name>choice2</name>
                    </item>
                    <item>
                        <itextId>static_instance-choices-2</itextId>
                        <name>choice3</name>
                    </item>
                    <item>
                        <itextId>static_instance-choices-3</itextId>
                        <name>choice4</name>
                    </item>
                    <item>
                        <itextId>static_instance-choices-4</itextId>
                        <name>choice5</name>
                    </item>
                </root>
            </instance>

            <instance id="cocoteros">
                <root>
                    <item>
                        <name>a-a</name>
                        <label>Cocotero a-a</label>
                    </item>
                    <item>
                        <name>a-b</name>
                        <label>Cocotero a-b</label>
                    </item>
                    <item>
                        <name>b-a</name>
                        <label>Cocotero b-a</label>
                    </item>
                    <item>
                        <name>b-b</name>
                        <label>Cocotero b-b</label>
                    </item>
                </root>
            </instance>

            <bind nodeset="/jr-choice-name/select_one_outside" type="string"/>

            <!-- the first parameter to jr:choice-name can be a literal string -->
            <bind calculate="jr:choice-name('choice2', ' /jr-choice-name/select_one_outside ')" nodeset="/jr-choice-name/literal_choice_name" type="string"/>
            <!-- the first parameter to jr:choice-name can be an XPath path -->
            <bind calculate="jr:choice-name(/jr-choice-name/select_one_outside , ' /jr-choice-name/select_one_outside')" nodeset="/jr-choice-name/select_one_name_outside" type="string"/>
            <!-- the first parameter to jr:choice-name can be any expression that returns a string -->
            <bind calculate="jr:choice-name(concat(/jr-choice-name/cocotero_a, '-', /jr-choice-name/cocotero_b), '/jr-choice-name/cocotero')" nodeset="/jr-choice-name/cocotero_name" type="string"/>

            <!-- both parameters to jr:choice-name can be relative XPath paths -->
            <bind nodeset="/jr-choice-name/my-repeat/select_one" type="string"/>
            <bind calculate="jr:choice-name( ../select_one , ' ../select_one ')" nodeset="/jr-choice-name/my-repeat/select_one_name" type="string"/>

            <!-- works with ranks too -->
            <bind nodeset="/jr-choice-name/rank" type="rank"/>
            <bind calculate="jr:choice-name( selected-at(/jr-choice-name/rank, 0) , ' /jr-choice-name/rank ')" nodeset="/jr-choice-name/rank_name" type="string"/>

            <bind jr:preload="uid" nodeset="/jr-choice-name/meta/instanceID" readonly="true()" type="string"/>
        </model>
    </h:head>
    <h:body>

        <input ref="/jr-choice-name/literal_choice_name">
            <label>the first parameter to jr:choice-name can be a literal string</label>
        </input>

        <input ref="/jr-choice-name/select_one_name_outside">
            <label>the first parameter to jr:choice-name can be an XPath path</label>
        </input>

        <input ref="/jr-choice-name/cocotero_name">
            <label>the first parameter to jr:choice-name can be any expression that returns a string</label>
        </input>

        <input ref="/jr-choice-name/my-repeat/select_one_name">
            <label>both parameters to jr:choice-name can be relative XPath paths</label>
        </input>

        <input ref="/jr-choice-name/rank_name">
            <label>works with ranks too</label>
        </input>

        <select1 ref="/jr-choice-name/select_one_outside">
            <label ref="jr:itext('/jr-choice-name/select_one_outside:label')"/>
            <item>
                <label ref="jr:itext('/jr-choice-name/select_one_outside/choice1:label')"/>
                <value>choice1</value>
            </item>
            <item>
                <label ref="jr:itext('/jr-choice-name/select_one_outside/choice2:label')"/>
                <value>choice2</value>
            </item>
            <item>
                <label ref="jr:itext('/jr-choice-name/select_one_outside/choice3:label')"/>
                <value>choice3</value>
            </item>
            <item>
                <label ref="jr:itext('/jr-choice-name/select_one_outside/choice4:label')"/>
                <value>choice4</value>
            </item>
            <item>
                <label ref="jr:itext('/jr-choice-name/select_one_outside/choice5:label')"/>
                <value>choice5</value>
            </item>
        </select1>

        <input ref="/jr-choice-name/cocotero_a">
            <label>Cocotero A</label>
        </input>
        <input ref="/jr-choice-name/cocotero_b">
            <label>Cocotero B</label>
        </input>
        <select1 ref="/jr-choice-name/cocotero">
            <label ref="jr:itext('/jr-choice-name/select_one_outside:label')"/>
            <itemset nodeset="instance('cocoteros')/root/item">
                <value ref="name"/>
                <label ref="label"/>
            </itemset>
        </select1>

        <group ref="/jr-choice-name/my-repeat">
            <label/>
            <repeat nodeset="/jr-choice-name/my-repeat">
                <select1 ref="/jr-choice-name/my-repeat/select_one">
                    <label ref="jr:itext('/jr-choice-name/my-repeat/select_one:label')"/>
                    <item>
                        <label ref="jr:itext('/jr-choice-name/my-repeat/select_one/choice1:label')"/>
                        <value>choice1</value>
                    </item>
                    <item>
                        <label ref="jr:itext('/jr-choice-name/my-repeat/select_one/choice2:label')"/>
                        <value>choice2</value>
                    </item>
                    <item>
                        <label ref="jr:itext('/jr-choice-name/my-repeat/select_one/choice3:label')"/>
                        <value>choice3</value>
                    </item>
                    <item>
                        <label ref="jr:itext('/jr-choice-name/my-repeat/select_one/choice4:label')"/>
                        <value>choice4</value>
                    </item>
                    <item>
                        <label ref="jr:itext('/jr-choice-name/my-repeat/select_one/choice5:label')"/>
                        <value>choice5</value>
                    </item>
                </select1>
            </repeat>
        </group>

        <odk:rank ref="/jr-choice-name/rank">
            <label>Rank</label>
            <itemset nodeset="instance('cocoteros')/root/item">
                <value ref="name"/>
                <label ref="label"/>
            </itemset>
        </odk:rank>
    </h:body>
</h:html>
