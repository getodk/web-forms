<?xml version="1.0" encoding="utf-8"?>
<h:html xmlns="http://www.w3.org/2002/xforms" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:odk="http://www.opendatakit.org/xforms">
  <h:head>
    <h:title>setgeopoint-action-new-repeat</h:title>
    <model>
      <instance>
        <data id="setgeopoint-action-new-repeat">
          <your_age />
          <person jr:template="">
            <age />
            <location />
          </person>
        </data>
      </instance>

      <bind nodeset="/data/your_age" type="integer" />
      <bind nodeset="/data/person/age" type="integer" />
      <bind nodeset="/data/person/location" type="geopoint" />
    </model>
  </h:head>
  <h:body>
    <input ref="/data/your_age">
      <label>Your age</label>
      <hint>Enter an integer value. This will be used to prefill age + 2 in each new repeat instance.</hint>
    </input>

    <group ref="/data/person">
      <label>Person Repeat Group</label>
      <repeat nodeset="/data/person">
        <setvalue event="odk-new-repeat" ref="age" value="../../your_age + 2" />
        <odk:setgeopoint event="odk-new-repeat" ref="location" />

        <input ref="age">
          <label>Person's age (prefilled on new repeat)</label>
        </input>

        <trigger ref="location">
          <label>Person's location (auto-captured on new repeat)</label>
          <hint>This is a read-only geopoint field that gets automatically populated with the current device location when a new repeat instance is added. No manual input needed.</hint>
        </trigger>
      </repeat>
    </group>
  </h:body>
</h:html>
